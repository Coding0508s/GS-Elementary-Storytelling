# ë°ì´í„°ë² ì´ìŠ¤ ë°±ì—… ê°€ì´ë“œ

## ğŸ“‹ ê°œìš”

ë°°í¬ ì „ì— ì„œë²„ì˜ ë°ì´í„°ë² ì´ìŠ¤ë¥¼ ë°±ì—…í•˜ëŠ” ë°©ë²•ì„ ì•ˆë‚´í•©ë‹ˆë‹¤.

## ğŸš€ ë¹ ë¥¸ ì‹œì‘

### ë¡œì»¬ì—ì„œ ë°±ì—… ì‹¤í–‰

```bash
# ë°±ì—… ìŠ¤í¬ë¦½íŠ¸ ì‹¤í–‰
./backup-database.sh
```

ë°±ì—… íŒŒì¼ì€ `backups/YYYYMMDD_HHMMSS/` ë””ë ‰í† ë¦¬ì— ì €ì¥ë©ë‹ˆë‹¤.

## ğŸ“¦ ë°±ì—… ë‚´ìš©

ë°±ì—… ìŠ¤í¬ë¦½íŠ¸ëŠ” ë‹¤ìŒì„ ë°±ì—…í•©ë‹ˆë‹¤:

1. **ë°ì´í„°ë² ì´ìŠ¤ íŒŒì¼/ë¤í”„**
   - SQLite: `database.sqlite` íŒŒì¼ ë³µì‚¬ + SQL ë¤í”„
   - MySQL/MariaDB: `mysqldump`ë¡œ SQL ë¤í”„ ìƒì„±
   - PostgreSQL: `pg_dump`ë¡œ SQL ë¤í”„ ìƒì„±

2. **í™˜ê²½ ì„¤ì • íŒŒì¼**
   - `.env` íŒŒì¼ (ì„ íƒì‚¬í•­)

3. **ë°±ì—… ì •ë³´**
   - `backup_info.txt`: ë°±ì—… ì¼ì‹œ, ë°ì´í„°ë² ì´ìŠ¤ íƒ€ì… ë“±

## ğŸ”§ ì„œë²„ì—ì„œ ë°±ì—… ì‹¤í–‰

### 1. ì„œë²„ì— ì ‘ì†

```bash
ssh user@your-server.com
cd /var/www/storytelling  # í”„ë¡œì íŠ¸ ë””ë ‰í† ë¦¬ë¡œ ì´ë™
```

### 2. ë°±ì—… ìŠ¤í¬ë¦½íŠ¸ ì‹¤í–‰

```bash
# ë°±ì—… ìŠ¤í¬ë¦½íŠ¸ ì‹¤í–‰
./backup-database.sh
```

### 3. ë°±ì—… íŒŒì¼ í™•ì¸

```bash
# ìµœì‹  ë°±ì—… ë””ë ‰í† ë¦¬ í™•ì¸
ls -lh backups/

# ë°±ì—… ë‚´ìš© í™•ì¸
ls -lh backups/YYYYMMDD_HHMMSS/
```

## ğŸ“¤ ë°±ì—… íŒŒì¼ ë‹¤ìš´ë¡œë“œ

### SCPë¥¼ ì‚¬ìš©í•œ ë‹¤ìš´ë¡œë“œ

```bash
# ë¡œì»¬ì—ì„œ ì‹¤í–‰
scp -r user@your-server.com:/var/www/storytelling/backups/YYYYMMDD_HHMMSS ./local-backups/
```

### SFTPë¥¼ ì‚¬ìš©í•œ ë‹¤ìš´ë¡œë“œ

```bash
# SFTP ì ‘ì†
sftp user@your-server.com

# ë°±ì—… ë””ë ‰í† ë¦¬ë¡œ ì´ë™
cd /var/www/storytelling/backups

# ìµœì‹  ë°±ì—… ë‹¤ìš´ë¡œë“œ
get -r YYYYMMDD_HHMMSS
```

## ğŸ”„ ë°±ì—… ë³µì›

### SQLite ë³µì›

```bash
# ë°±ì—… íŒŒì¼ë¡œ ë³µì›
cp backups/YYYYMMDD_HHMMSS/database.sqlite database/database.sqlite

# ë˜ëŠ” SQL ë¤í”„ë¡œ ë³µì›
sqlite3 database/database.sqlite < backups/YYYYMMDD_HHMMSS/database.sql
```

### MySQL/MariaDB ë³µì›

```bash
# ë°ì´í„°ë² ì´ìŠ¤ ë³µì›
mysql -u username -p database_name < backups/YYYYMMDD_HHMMSS/database.sql
```

### PostgreSQL ë³µì›

```bash
# ë°ì´í„°ë² ì´ìŠ¤ ë³µì›
psql -U username -d database_name < backups/YYYYMMDD_HHMMSS/database.sql
```

## âš ï¸ ì£¼ì˜ì‚¬í•­

1. **ë°±ì—… íŒŒì¼ ë³´ì•ˆ**
   - ë°±ì—… íŒŒì¼ì—ëŠ” ë¯¼ê°í•œ ì •ë³´ê°€ í¬í•¨ë  ìˆ˜ ìˆìŠµë‹ˆë‹¤
   - ì•ˆì „í•œ ìœ„ì¹˜ì— ì €ì¥í•˜ê³  ì ‘ê·¼ ê¶Œí•œì„ ì œí•œí•˜ì„¸ìš”

2. **ë°±ì—… ê³µê°„ í™•ì¸**
   - ë°±ì—… íŒŒì¼ì€ ë°ì´í„°ë² ì´ìŠ¤ í¬ê¸°ì— ë”°ë¼ ìƒë‹¹í•œ ê³µê°„ì„ ì°¨ì§€í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤
   - ì •ê¸°ì ìœ¼ë¡œ ì˜¤ë˜ëœ ë°±ì—…ì„ ì‚­ì œí•˜ì„¸ìš”

3. **ë°±ì—… ê²€ì¦**
   - ë°±ì—… í›„ ë°±ì—… íŒŒì¼ì´ ì œëŒ€ë¡œ ìƒì„±ë˜ì—ˆëŠ”ì§€ í™•ì¸í•˜ì„¸ìš”
   - í•„ìš”ì‹œ ë³µì› í…ŒìŠ¤íŠ¸ë¥¼ ìˆ˜í–‰í•˜ì„¸ìš”

## ğŸ”„ ìë™ ë°±ì—… ì„¤ì •

### Cronì„ ì‚¬ìš©í•œ ìë™ ë°±ì—…

```bash
# crontab í¸ì§‘
crontab -e

# ë§¤ì¼ ìƒˆë²½ 2ì‹œì— ë°±ì—… ì‹¤í–‰
0 2 * * * cd /var/www/storytelling && ./backup-database.sh

# ë˜ëŠ” ì£¼ 1íšŒ (ë§¤ì£¼ ì¼ìš”ì¼ ìƒˆë²½ 2ì‹œ)
0 2 * * 0 cd /var/www/storytelling && ./backup-database.sh
```

### ì˜¤ë˜ëœ ë°±ì—… ìë™ ì‚­ì œ

ë°±ì—… ìŠ¤í¬ë¦½íŠ¸ì— ë‹¤ìŒì„ ì¶”ê°€í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤:

```bash
# 30ì¼ ì´ìƒ ëœ ë°±ì—… ì‚­ì œ
find backups/ -type d -mtime +30 -exec rm -rf {} \;
```

## ğŸ“Š ë°±ì—… ì „ëµ ê¶Œì¥ì‚¬í•­

1. **ë°°í¬ ì „ ë°±ì—…**: ë°°í¬ ì „ì— í•­ìƒ ë°±ì—…ì„ ì‹¤í–‰í•˜ì„¸ìš”
2. **ì •ê¸° ë°±ì—…**: ë§¤ì¼ ë˜ëŠ” ì£¼ 1íšŒ ìë™ ë°±ì—… ì„¤ì •
3. **ë°±ì—… ë³´ê´€**: ìµœì†Œ 7ì¼, ê¶Œì¥ 30ì¼ ì´ìƒ ë³´ê´€
4. **ë°±ì—… ê²€ì¦**: ì£¼ê¸°ì ìœ¼ë¡œ ë°±ì—… íŒŒì¼ì˜ ë¬´ê²°ì„± í™•ì¸
5. **ì˜¤í”„ì‚¬ì´íŠ¸ ë°±ì—…**: ì¤‘ìš”í•œ ë°ì´í„°ëŠ” ë‹¤ë¥¸ ì„œë²„ë‚˜ í´ë¼ìš°ë“œì— ë°±ì—…

## ğŸ†˜ ë¬¸ì œ í•´ê²°

### ë°±ì—… ì‹¤íŒ¨ ì‹œ

1. **ê¶Œí•œ í™•ì¸**
   ```bash
   chmod +x backup-database.sh
   ```

2. **ë°ì´í„°ë² ì´ìŠ¤ ê²½ë¡œ í™•ì¸**
   ```bash
   php artisan tinker --execute="echo config('database.connections.sqlite.database');"
   ```

3. **ë””ìŠ¤í¬ ê³µê°„ í™•ì¸**
   ```bash
   df -h
   ```

4. **ë¡œê·¸ í™•ì¸**
   ```bash
   ./backup-database.sh 2>&1 | tee backup.log
   ```

## ğŸ“ ì§€ì›

ë°±ì—… ê´€ë ¨ ë¬¸ì œê°€ ë°œìƒí•˜ë©´ ë¡œê·¸ë¥¼ í™•ì¸í•˜ê³  ê´€ë¦¬ìì—ê²Œ ë¬¸ì˜í•˜ì„¸ìš”.

